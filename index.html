<!DOCTYPE html>
<html lang="es-CL">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<meta name="theme-color" content="#3B82F6">
<link rel="manifest" href="manifest.json">
<link rel="apple-touch-icon" href="icons/icon-192.png">
<title>Mis Comidas</title>
<style>
*{margin:0;padding:0;box-sizing:border-box}
body{font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,sans-serif;background:#f8fafc;overflow-x:hidden;transition:background-color 0.3s ease}
.header{background:linear-gradient(135deg,#3b82f6,#9333ea);color:#fff;padding:1.5rem;text-align:center}
.header h1{font-size:1.5rem;margin-bottom:.25rem}
.header p{font-size:.9rem;opacity:.9;text-transform:capitalize}
.container{padding:1rem 1rem 6rem 1rem}
.meal-card{background:#fff;border-radius:1rem;padding:1rem;margin-bottom:1rem;box-shadow:0 2px 8px rgba(0,0,0,.1);transition:background-color 0.3s ease}
.meal-card.pending{background:linear-gradient(135deg,#faf5ff,#f3e8ff);border:2px solid #d8b4fe}
.meal-card.completed{background:linear-gradient(135deg,#eff6ff,#dbeafe);border:2px solid #93c5fd}
.meal-card.late{background:linear-gradient(135deg,#eef2ff,#e0e7ff);border:2px solid #a5b4fc}
.meal-card h3{color:#1e293b;margin-bottom:.5rem;font-size:1.1rem;transition:color 0.3s ease}
.meal-card p{color:#64748b;font-size:.9rem;margin-bottom:.75rem;transition:color 0.3s ease}
.status{display:inline-block;padding:.25rem .75rem;border-radius:1rem;font-size:.75rem;font-weight:600}
.status.pending{background:#a855f7;color:#fff}
.status.completed{background:#3b82f6;color:#fff}
.status.late{background:#6366f1;color:#fff}
.btn{border:none;padding:.75rem 1.5rem;border-radius:.5rem;font-weight:600;cursor:pointer;font-size:.95rem;width:100%;margin-top:.5rem;transition:all 0.2s ease}
.btn-primary{background:linear-gradient(135deg,#3b82f6,#9333ea);color:#fff}
.btn-secondary{background:#e2e8f0;color:#475569}
.btn-danger{background:#ef4444;color:#fff}
.btn-group{display:flex;gap:.5rem}
.btn-group .btn{flex:1}
.nav{position:fixed;bottom:0;left:0;right:0;background:#fff;border-top:2px solid #e2e8f0;display:flex;justify-content:space-around;padding:.5rem;z-index:100;transition:background-color 0.3s ease}
.nav button{background:none;border:none;padding:.5rem 1rem;font-size:.75rem;color:#64748b;display:flex;flex-direction:column;align-items:center;gap:.25rem;cursor:pointer;transition:color 0.3s ease}
.nav button.active{color:#3b82f6;font-weight:600}
.modal{display:none;position:fixed;inset:0;background:rgba(0,0,0,.5);z-index:200;padding:1rem;align-items:center;justify-content:center}
.modal.show{display:flex}
.modal-content{background:#fff;border-radius:1rem;padding:1.5rem;max-width:400px;width:100%;max-height:90vh;overflow-y:auto;transition:background-color 0.3s ease}
.modal-content h2{margin-bottom:1rem;color:#1e293b;transition:color 0.3s ease}
.form-group{margin-bottom:1rem}
.form-group label{display:block;margin-bottom:.5rem;color:#475569;font-weight:600;font-size:.9rem;transition:color 0.3s ease}
.form-group input,.form-group select,.form-group textarea{width:100%;padding:.75rem;border:2px solid #cbd5e1;border-radius:.5rem;font-family:inherit;font-size:.95rem;transition:all 0.3s ease}
.form-group textarea{min-height:80px;resize:vertical}
.form-group input:disabled{background:#f1f5f9;color:#94a3b8}
.time-setting{display:flex;justify-content:space-between;align-items:center;padding:.75rem;background:#f8fafc;border-radius:.5rem;margin-bottom:.5rem;transition:background-color 0.3s ease}
.time-setting input[type="time"]{width:auto;padding:.5rem;border:2px solid #cbd5e1;border-radius:.5rem}
.history-item{border-left:4px solid #3b82f6;padding-left:.75rem;margin-bottom:1rem}
.history-item .time{color:#64748b;font-size:.85rem;margin-bottom:.25rem;transition:color 0.3s ease}
.history-item .desc{color:#334155;margin:.25rem 0;transition:color 0.3s ease}
.category-tag{display:inline-block;padding:.25rem .5rem;background:#dbeafe;color:#1e40af;border-radius:.25rem;font-size:.75rem;margin-top:.25rem;transition:all 0.3s ease}
.stats-grid{display:grid;grid-template-columns:1fr 1fr;gap:1rem;margin-bottom:1rem}
.stat-card{padding:1.5rem;border-radius:1rem;text-align:center}
.stat-card.blue{background:linear-gradient(135deg,#dbeafe,#bfdbfe)}
.stat-card.purple{background:linear-gradient(135deg,#e9d5ff,#d8b4fe)}
.stat-card p{margin:0;font-size:.9rem}
.stat-card.blue p{color:#1e40af}
.stat-card.purple p{color:#7c3aed}
.stat-card h2{margin:.5rem 0 0 0;font-size:2.5rem}
.stat-card.blue h2{color:#1e40af}
.stat-card.purple h2{color:#7c3aed}
.empty-state{text-align:center;padding:3rem 1rem;color:#94a3b8;transition:color 0.3s ease}
.empty-state .icon{font-size:4rem;margin-bottom:1rem}
.tutorial{position:fixed;inset:0;background:linear-gradient(135deg,#eff6ff,#faf5ff);z-index:300;display:flex;align-items:center;justify-content:center;padding:2rem}
.tutorial-content{background:#fff;border-radius:1.5rem;padding:2rem;max-width:400px;text-align:center;box-shadow:0 20px 40px rgba(0,0,0,.1)}
.tutorial-icon{font-size:4rem;margin-bottom:1rem}
.tutorial h2{color:#1e293b;margin-bottom:1rem}
.tutorial p{color:#64748b;margin-bottom:2rem;line-height:1.6}
.dots{display:flex;gap:.5rem;justify-content:center;margin-bottom:1.5rem}
.dot{width:2rem;height:.5rem;background:#e2e8f0;border-radius:1rem}
.dot.active{background:#3b82f6}
.warning{background:#fffbeb;border:2px solid #fcd34d;border-radius:.75rem;padding:1rem;margin-bottom:1rem;transition:all 0.3s ease}
.warning p{color:#92400e;font-size:.85rem;line-height:1.5}
.checkbox-group{display:flex;justify-content:space-between;align-items:center;padding:.75rem;background:#f8fafc;border-radius:.5rem;margin-bottom:.5rem;transition:background-color 0.3s ease}
.checkbox-group input[type="checkbox"]{width:1.5rem;height:1.5rem;cursor:pointer}
body.dark{background:#0f172a}
body.dark .meal-card{background:#1e293b;box-shadow:0 2px 8px rgba(0,0,0,.3)}
body.dark .meal-card.pending{background:linear-gradient(135deg,#1e1b4b,#312e81);border-color:#4c1d95}
body.dark .meal-card.completed{background:linear-gradient(135deg,#1e3a8a,#1e40af);border-color:#3b82f6}
body.dark .meal-card.late{background:linear-gradient(135deg,#312e81,#3730a3);border-color:#6366f1}
body.dark .meal-card h3{color:#f1f5f9}
body.dark .meal-card p{color:#94a3b8}
body.dark .nav{background:#1e293b;border-top-color:#334155}
body.dark .nav button{color:#94a3b8}
body.dark .nav button.active{color:#60a5fa}
body.dark .modal-content{background:#1e293b}
body.dark .modal-content h2{color:#f1f5f9}
body.dark .form-group label{color:#cbd5e1}
body.dark .form-group input,body.dark .form-group select,body.dark .form-group textarea{background:#0f172a;border-color:#334155;color:#f1f5f9}
body.dark .form-group input:disabled{background:#1e293b;color:#64748b}
body.dark .time-setting{background:#0f172a;color:#f1f5f9}
body.dark .checkbox-group{background:#0f172a;color:#f1f5f9}
body.dark .btn-secondary{background:#334155;color:#cbd5e1}
body.dark .history-item .time{color:#94a3b8}
body.dark .history-item .desc{color:#cbd5e1}
body.dark .category-tag{background:#1e3a8a;color:#93c5fd}
body.dark .empty-state{color:#64748b}
body.dark .warning{background:#422006;border-color:#78350f}
body.dark .warning p{color:#fde68a}
body.dark .tutorial-content{background:#1e293b}
body.dark .tutorial h2{color:#f1f5f9}
body.dark .tutorial p{color:#94a3b8}
</style>
</head>
<body>
<div id="app"></div>
<script>
const app=document.getElementById('app');
let screen='loading';
let tutorialStep=0;
let showModal=false;
let modalType='';
let selectedMeal=null;
let mealDesc='';
let mealCat='saludable';
let showMoreMenu=false;
let darkMode=false;
let settings={mealTimes:{breakfast:'08:00',lunch:'13:00',snack:'16:00',dinner:'20:00'},notificationsEnabled:true,reminderMinutes:5};
let tempSettings={...settings,mealTimes:{...settings.mealTimes}};
let meals=[];
const mealNames={breakfast:'Desayuno',lunch:'Almuerzo',snack:'Once',dinner:'Cena'};

function checkNotifications(){
  if(!settings.notificationsEnabled||Notification.permission!=='granted')return;
  const now=new Date();
  const currentTime=`${now.getHours().toString().padStart(2,'0')}:${now.getMinutes().toString().padStart(2,'0')}`;
  const today=now.toISOString().split('T')[0];
  Object.keys(settings.mealTimes).forEach(type=>{
    const entry=meals.find(m=>m.date===today&&m.mealType===type);
    if(entry)return;
    const mealTime=settings.mealTimes[type];
    const[mh,mm]=mealTime.split(':').map(Number);
    const reminderTime=new Date(now.getFullYear(),now.getMonth(),now.getDate(),mh,mm);
    reminderTime.setMinutes(reminderTime.getMinutes()-settings.reminderMinutes);
    const reminderStr=`${reminderTime.getHours().toString().padStart(2,'0')}:${reminderTime.getMinutes().toString().padStart(2,'0')}`;
    if(currentTime===reminderStr&&settings.reminderMinutes>0){
      new Notification('‚è∞ Recordatorio de Comida',{body:`En ${settings.reminderMinutes} minutos es hora de ${mealNames[type].toLowerCase()}`});
    }
    if(currentTime===mealTime){
      new Notification('üçΩÔ∏è Hora de Comer',{body:`Es hora de ${mealNames[type].toLowerCase()}`});
    }
  });
}

function toggleDarkMode(){
  darkMode=!darkMode;
  if(darkMode){
    document.body.classList.add('dark');
    localStorage.setItem('darkMode','true');
  }else{
    document.body.classList.remove('dark');
    localStorage.setItem('darkMode','false');
  }
  render();
}

function getMealStatus(type){
  const today=new Date().toISOString().split('T')[0];
  const entry=meals.find(m=>m.date===today&&m.mealType===type);
  if(entry)return entry.skipped?'skipped':'completed';
  const[h,m]=settings.mealTimes[type].split(':').map(Number);
  const now=new Date();
  const sched=new Date(now.getFullYear(),now.getMonth(),now.getDate(),h,m);
  return now>sched?'late':'pending';
}

function getTodayEntry(type){
  const today=new Date().toISOString().split('T')[0];
  return meals.find(m=>m.date===today&&m.mealType===type);
}

function addMeal(type){
  selectedMeal=type;
  modalType='register';
  showModal=true;
  render();
}

function saveMeal(){
  if(!mealDesc.trim()){
    alert('Por favor describe qu√© comiste');
    return;
  }
  const now=new Date();
  meals.push({
    id:Date.now(),
    date:now.toISOString().split('T')[0],
    mealType:selectedMeal,
    scheduledTime:settings.mealTimes[selectedMeal],
    actualTime:now.toTimeString().slice(0,5),
    description:mealDesc,
    category:mealCat,
    skipped:false
  });
  localStorage.setItem('mealHistory',JSON.stringify(meals));
  showModal=false;
  mealDesc='';
  mealCat='saludable';
  render();
}

function skipMeal(type){
  const now=new Date();
  meals.push({
    id:Date.now(),
    date:now.toISOString().split('T')[0],
    mealType:type,
    scheduledTime:settings.mealTimes[type],
    actualTime:null,
    description:'',
    category:'',
    skipped:true
  });
  localStorage.setItem('mealHistory',JSON.stringify(meals));
  render();
}

function openSettings(){
  tempSettings={...settings,mealTimes:{...settings.mealTimes}};
  modalType='settings';
  showModal=true;
  showMoreMenu=false;
  render();
}

function saveSettings(){
  settings={...tempSettings};
  localStorage.setItem('mealSettings',JSON.stringify(settings));
  showModal=false;
  alert('‚úÖ Cambios guardados correctamente');
  render();
}

function deleteAllData(){
  if(confirm('¬øEst√°s seguro? Esto eliminar√° todo tu historial y configuraci√≥n.\\n\\nEsta acci√≥n no se puede deshacer.')){
    localStorage.clear();
    location.reload();
  }
}

function openSupport(){
  modalType='support';
  showModal=true;
  showMoreMenu=false;
  render();
}

function restartTutorial(){
  localStorage.setItem('tutorialCompleted','false');
  tutorialStep=0;
  screen='tutorial';
  showModal=false;
  render();
}

function skipTutorial(){
  localStorage.setItem('tutorialCompleted','true');
  screen='dashboard';
  render();
}

function nextTutorial(){
  if(tutorialStep<3){
    tutorialStep++;
    render();
  }else{
    skipTutorial();
  }
}

function render(){
  if(screen==='loading'){
    app.innerHTML='<div class="empty-state"><div class="icon">üçΩÔ∏è</div><p>Cargando...</p></div>';
    return;
  }
  if(screen==='tutorial'){
    const tutorials=[
      {icon:'üçΩÔ∏è',title:'¬°Bienvenido!',text:'Esta app te ayudar√° a recordar y registrar tus comidas diarias.'},
      {icon:'‚è∞',title:'Configura horarios',text:'Define a qu√© hora comes cada d√≠a. La app te recordar√°.'},
      {icon:'‚úÖ',title:'Registra comidas',text:'Presiona "Ya com√≠" y describe qu√© comiste.'},
      {icon:'üìä',title:'Ve tu progreso',text:'Revisa tu historial y estad√≠sticas.'}
    ];
    const t=tutorials[tutorialStep];
    app.innerHTML=`<div class="tutorial"><div class="tutorial-content"><div class="tutorial-icon">${t.icon}</div><h2>${t.title}</h2><p>${t.text}</p><div class="dots">${tutorials.map((_,i)=>`<div class="dot ${i===tutorialStep?'active':''}"></div>`).join('')}</div><div class="btn-group"><button class="btn btn-secondary" onclick="skipTutorial()">Saltar</button><button class="btn btn-primary" onclick="nextTutorial()">${tutorialStep<3?'Siguiente':'Comenzar'}</button></div></div></div>`;
    return;
  }
  let content='';
  if(screen==='dashboard'){
    const today=new Date().toLocaleDateString('es-CL',{weekday:'long',year:'numeric',month:'long',day:'numeric'});
    content=`<div class="header"><h1>Panel Principal</h1><p>${today}</p></div><div class="container">${Object.keys(settings.mealTimes).map(type=>{
      const status=getMealStatus(type);
      const entry=getTodayEntry(type);
      return`<div class="meal-card ${status}"><div style="display:flex;justify-content:space-between;align-items:start;margin-bottom:.75rem"><div><h3>${mealNames[type]}</h3><p>‚è∞ ${settings.mealTimes[type]}</p></div><span class="status ${status}">${status==='completed'?'Registrada':status==='late'?'Atrasada':'Pendiente'}</span></div>${entry&&!entry.skipped?`<div style="background:${darkMode?'#0f172a':'#fff'};padding:.75rem;border-radius:.5rem;margin-bottom:.75rem"><p style="color:${darkMode?'#94a3b8':'#64748b'};font-size:.85rem">Hora real: ${entry.actualTime}</p><p style="color:${darkMode?'#f1f5f9':'#1e293b'};margin:.25rem 0">${entry.description}</p><span class="category-tag">${entry.category}</span></div>`:''}${status!=='completed'&&status!=='skipped'?`<div class="btn-group"><button class="btn btn-primary" onclick="addMeal('${type}')">Ya com√≠</button><button class="btn btn-secondary" onclick="skipMeal('${type}')">Saltar</button></div>`:''}</div>`;
    }).join('')}</div>`;
  }
  if(screen==='history'){
    const grouped={};
    meals.forEach(m=>{if(!grouped[m.date])grouped[m.date]=[];grouped[m.date].push(m);});
    const dates=Object.keys(grouped).sort().reverse();
    content=`<div class="header"><h1>Historial</h1></div><div class="container">${dates.length===0?`<div class="empty-state"><div class="icon">üìÖ</div><p>A√∫n no has registrado comidas</p></div>`:dates.map(date=>`<div class="meal-card"><h3 style="color:#3b82f6;margin-bottom:1rem">${new Date(date+'T12:00').toLocaleDateString('es-CL',{weekday:'long',day:'numeric',month:'long'})}</h3>${grouped[date].map(m=>`<div class="history-item"><div style="display:flex;justify-content:space-between"><strong>${mealNames[m.mealType]}</strong><span class="time">${m.skipped?'Saltada':m.actualTime}</span></div>${!m.skipped?`<p class="desc">${m.description}</p><span class="category-tag">${m.category}</span>`:''}</div>`).join('')}</div>`).join('')}</div>`;
  }
  if(screen==='stats'){
    const week=meals.filter(m=>{const d=new Date(m.date);const w=new Date();w.setDate(w.getDate()-7);return d>=w;});
    const cats={};
    week.forEach(m=>{if(!m.skipped&&m.category)cats[m.category]=(cats[m.category]||0)+1;});
    content=`<div class="header"><h1>Estad√≠sticas</h1><p>√öltima semana</p></div><div class="container"><div class="stats-grid"><div class="stat-card blue"><p>Esta semana</p><h2>${week.filter(m=>!m.skipped).length}</h2></div><div class="stat-card purple"><p>Total</p><h2>${meals.filter(m=>!m.skipped).length}</h2></div></div>${Object.keys(cats).length>0?`<div class="meal-card"><h3 style="margin-bottom:1rem">üìä Por categor√≠a</h3>${Object.entries(cats).map(([c,n])=>`<div style="display:flex;justify-content:space-between;padding:.5rem;background:${darkMode?'#0f172a':'#f8fafc'};border-radius:.5rem;margin-bottom:.5rem"><span style="text-transform:capitalize">${c}</span><strong style="color:#3b82f6">${n}</strong></div>`).join('')}</div>`:''}</div>`;
  }
  app.innerHTML=content+`<div class="nav"><button class="${screen==='dashboard'?'active':''}" onclick="screen='dashboard';showMoreMenu=false;render()">üè†<br>Panel</button><button class="${screen==='history'?'active':''}" onclick="screen='history';showMoreMenu=false;render()">üìÖ<br>Historial</button><button class="${screen==='stats'?'active':''}" onclick="screen='stats';showMoreMenu=false;render()">üìä<br>Stats</button><button onclick="showMoreMenu=!showMoreMenu;render()">‚ò∞<br>M√°s</button></div>${showMoreMenu?`<div style="position:fixed;bottom:4.5rem;right:1rem;background:${darkMode?'#1e293b':'#fff'};border-radius:.75rem;box-shadow:0 4px 12px rgba(0,0,0,.15);border:2px solid ${darkMode?'#334155':'#e2e8f0'};min-width:180px;z-index:150"><button onclick="openSettings()" style="width:100%;text-align:left;padding:1rem;border:none;background:none;display:flex;align-items:center;gap:.75rem;cursor:pointer;color:${darkMode?'#cbd5e1':'inherit'}">‚öôÔ∏è <span>Configuraci√≥n</span></button><button onclick="openSupport()" style="width:100%;text-align:left;padding:1rem;border:none;background:none;display:flex;align-items:center;gap:.75rem;cursor:pointer;border-top:1px solid ${darkMode?'#334155':'#e2e8f0'};color:${darkMode?'#cbd5e1':'inherit'}">‚ùì <span>Soporte</span></button></div>`:''}${showModal&&modalType==='register'?`<div class="modal show"><div class="modal-content"><h2>Registrar ${mealNames[selectedMeal]}</h2><div class="form-group"><label>Hora actual</label><input type="text" value="${new Date().toTimeString().slice(0,5)}" disabled></div><div class="form-group"><label>¬øQu√© comiste?</label><textarea placeholder="Describe tu comida..." oninput="mealDesc=this.value">${mealDesc}</textarea></div><div class="form-group"><label>Categor√≠a</label><select onchange="mealCat=this.value"><option value="saludable">Saludable</option><option value="chatarra">Chatarra</option><option value="casera">Casera</option><option value="otra">Otra</option></select></div><div class="btn-group"><button class="btn btn-secondary" onclick="showModal=false;mealDesc='';render()">Cancelar</button><button class="btn btn-primary" onclick="saveMeal()">Guardar</button></div></div></div>`:''}${showModal&&modalType==='settings'?`<div class="modal show"><div class="modal-content"><h2>‚öôÔ∏è Configuraci√≥n</h2><h3 style="margin-bottom:.75rem;color:${darkMode?'#f1f5f9':'#1e293b'}">Horarios de comidas</h3>${Object.entries(mealNames).map(([key,name])=>`<div class="time-setting"><span>${name}</span><input type="time" value="${tempSettings.mealTimes[key]}" onchange="tempSettings.mealTimes['${key}']=this.value"></div>`).join('')}<h3 style="margin:1.5rem 0 .75rem 0;color:${darkMode?'#f1f5f9':'#1e293b'}">Notificaciones</h3><div class="checkbox-group"><span>Activar recordatorios</span><input type="checkbox" ${tempSettings.notificationsEnabled?'checked':''} onchange="tempSettings.notificationsEnabled=this.checked"></div><div class="form-group"><label>Recordar minutos antes</label><select value="${tempSettings.reminderMinutes}" onchange="tempSettings.reminderMinutes=Number(this.value)"><option value="0" ${tempSettings.reminderMinutes===0?'selected':''}>0 minutos</option><option value="5" ${tempSettings.reminderMinutes===5?'selected':''}>5 minutos</option><option value="10" ${tempSettings.reminderMinutes===10?'selected':''}>10 minutos</option><option value="15" ${tempSettings.reminderMinutes===15?'selected':''}>15 minutos</option><option value="30" ${tempSettings.reminderMinutes===30?'selected':''}>30 minutos</option></select></div><h3 style="margin:1.5rem 0 .75rem 0;color:${darkMode?'#f1f5f9':'#1e293b'}">Apariencia</h3><div class="checkbox-group"><span>${darkMode?'Desactivar':'Activar'} modo oscuro</span><input type="checkbox" ${darkMode?'checked':''} onchange="toggleDarkMode()"></div><div class="warning"><p>‚ö†Ô∏è Tus datos se guardan localmente. Si desinstalas la app o borras datos del navegador, perder√°s tu informaci√≥n.</p></div><button class="btn btn-primary" onclick="saveSettings()">Guardar cambios</button><button class="btn btn-danger" onclick="deleteAllData()" style="margin-top:.5rem">Borrar todos mis datos</button><button class="btn btn-secondary" onclick="showModal=false;render()" style="margin-top:.5rem">Cancelar</button></div></div>`:''}${showModal&&modalType==='support'?`<div class="modal show"><div class="modal-content"><h2>‚ùì Soporte</h2><h3 style="margin-bottom:.75rem;color:${darkMode?'#f1f5f9':'#1e293b'}">Preguntas frecuentes</h3><div class="meal-card"><h4 style="color:#3b82f6;margin-bottom:.5rem">¬øC√≥mo cambio los horarios?</h4><p style="font-size:.9rem;color:#64748b">Ve a Configuraci√≥n en el men√∫ M√°s y ajusta los horarios de cada comida.</p></div><div class="meal-card"><h4 style="color:#3b82f6;margin-bottom:.5rem">¬øC√≥mo funcionan las notificaciones?</h4><p style="font-size:.9rem;color:#64748b">La app te notificar√° minutos antes (seg√∫n configures) y a la hora exacta de cada comida.</p></div><div class="meal-card"><h4 style="color:#3b82f6;margin-bottom:.5rem">¬øD√≥nde se guardan mis datos?</h4><p style="font-size:.9rem;color:#64748b">Todos tus datos se guardan localmente en tu dispositivo.</p></div><button class="btn btn-primary" onclick="restartTutorial()">Ver tutorial nuevamente</button><div style="background:${darkMode?'#0f172a':'#f1f5f9'};padding:1rem;border-radius:.75rem;text-align:center;margin-top:1rem"><p style="font-size:.85rem;color:${darkMode?'#94a3b8':'#64748b'}">Versi√≥n 1.0</p><p style="font-size:.75rem;color:${darkMode?'#64748b':'#94a3b8'};margin-top:.25rem">Desarrollado con HTML/JS</p></div><button class="btn btn-secondary" onclick="showModal=false;render()" style="margin-top:1rem">Cerrar</button></div></div>`:''}`;
}
// Registrar Service Worker
if('serviceWorker' in navigator){
  navigator.serviceWorker.register('service-worker.js')
    .then(reg=>console.log('SW registrado',reg))
    .catch(err=>console.log('SW error',err));
}
  
function init(){
  const tutDone=localStorage.getItem('tutorialCompleted');
  const savedSettings=localStorage.getItem('mealSettings');
  const savedMeals=localStorage.getItem('mealHistory');
  const savedDarkMode=localStorage.getItem('darkMode');
  if(savedSettings){
    settings=JSON.parse(savedSettings);
    tempSettings={...settings,mealTimes:{...settings.mealTimes}};
  }
  if(savedMeals)meals=JSON.parse(savedMeals);
  if(savedDarkMode==='true'){
    darkMode=true;
    document.body.classList.add('dark');
  }
  screen=tutDone==='true'?'dashboard':'tutorial';
  if('Notification' in window&&Notification.permission==='default'){
    Notification.requestPermission();
  }
  checkNotifications();
  setInterval(checkNotifications,60000);
  render();
}

init();
</script>
</body>
</html>
